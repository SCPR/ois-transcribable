<%= simple_form_for(@incident) do |f| %>

    <%= submit_tag "Submit The Edited Information", :class => "btn btn-success btn-lg btn-block", :id => "incidentsubmit"  %>

    <div class="overflow form-fields">

        <% if @incident.errors.any? %>
            <div class="invalid">
                <h6><%= pluralize(@incident.errors.count, "error") %> prohibited this transcription from being saved:</h6>
                <ul>
                    <% @incident.errors.full_messages.each do |msg| %>
                        <li><%= msg %></li>
                    <% end %>
                </ul>
            </div>
        <% end %>

        <div class="do_something">
            <div class="field" id="transcribed_status">
                <%= f.input :transcribed_status, collection: ["in-progress", "transcribed", "verified"], label: false, :default => "in-progress", :prompt => " --Select One-- ", class: "form-control", label: "Transcription Status" %>
            </div>
        </div>

        <!-- begin initial data -->
        <h5>Initial Information</h5>

        <%= f.input :incident_url, :as => :hidden, :input_html => { :value => @incident.incident_url } %>

        <div class="do_something">
            <%= f.input :district_attorney_county, class: "form-control", label: "District Attorney's County", input_html: {value: @incident.split_url["county"]} %>
        </div>

        <div class="do_something">
            <%= f.input :district_attorney_file_number, class: "form-control", label: "District Attorney File Number", input_html: {value: @incident.split_url["file_number"]} %>
        </div>

        <div class="do_something">
            <%= f.input :district_attorney_date_of_letter, class: "form-control", as: :date, start_year: Date.today.year - 15, end_year: Date.today.year, order: [:month, :day,  :year], label: "District Attorney Date Of Letter" %>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :officer_police_agency, class: "form-control", label: "Law Enforcement Agency (Separate With Commas)" %>
            </div>
        </div>

        <div class="do_something">
            <%= f.input :date_of_incident, class: "form-control", as: :datetime, start_year: Date.today.year - 15, end_year: Date.today.year, label: "Date & Time Of Incident" %>
        </div>

        <label class="string optional control-label" style="color: #468849;">Check any of the following if true</label>

        <div class="row">
            <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :on_duty_shooting_case, class: "form-control", label: "Was This An On-Duty Shooting?" %>
                    </label>
                </div>
            </div>
            <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :person_killed, class: "form-control", label: "Was This A Fatal Shooting?" %>
                    </label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :multiple_officers, class: "form-control", label: "Were Multiple Officers Involved?" %>
                    </label>
                </div>
            </div>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :officer_name_and_badge_number, class: "form-control", label: "Officer Names (Badge Numbers In Parentheses. Separate With Commas)" %>
            </div>
        </div>

        <div class="do_something">
            <label class="checkbox-inline">
                <%= f.input :officer_charges_filed, class: "form-control", label: "Charges Filed Against Officer? (Check box if true)" %>
            </label>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :officer_charges_filed_yes_detail, class: "form-control", label: "Charges If Officer Charged" %>
            </div>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <div class="form-group text optional">
                    <label class="text optional control-label">If No Charges What Was Justification? (Check those that apply)</label>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_self_defense, class: "form-control", label: "Self Defense" %>
                    </label>
                </div>
            </div>
            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">

                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_defense_of_officers, class: "form-control", label: "Defense Of Officers" %>
                    </label>
                </div>
            </div>
            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">

                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_defense_of_civillians, class: "form-control", label: "Defense Of Civillians" %>
                    </label>
                </div>
            </div>
        </div>

        <div class="do_something">
            <%= f.input :district_attorney_on_scene, class: "form-control", label: "District Attorney On Scene" %>
        </div>

        <div class="do_something">
            <%= f.input :district_attorney_investigator_on_scene, class: "form-control", label: "District Attorney Investigator On Scene" %>
        </div>
        <!-- end initial data -->

        <hr></hr>

        <!-- NEED TO FIGURE OUT THE PEOPLE -->
        <h5>Associated People</h5>
        <% if @people.count == 0 %>
            <%= f.simple_fields_for :people, @incident.people.build do |p| %>
                <%= p.input :incident_url, :as => :hidden, :input_html => { :value => @incident.incident_url } %>
                <%= p.input :district_attorney_file_number, :as => :hidden, :input_html => {value: @incident.split_url["file_number"]} %>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= p.input :case_doubled_up, class: "form-control", label: "Were Multiple People Shot" %>
                    </label>
                </div>
                <div class="do_something">
                    <%= p.input :person_name, class: "form-control", label: "Name" %>
                </div>
                <div class="do_something">
                    <div class="field" id="person_gender">
                    <%= p.input :person_gender, class: "form-control", label: "Gender" %>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="person_ethnicity">
                    <%= p.input :person_ethnicity, class: "form-control", label: "Ethnicity" %>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="person_age">
                    <%= p.input :person_age, class: "form-control", label: "Age" %>
                    </div>
                </div>
                <div class="do_something">
                    <%= p.input :person_date_of_birth, class: "form-control", as: :date, start_year: Date.today.year - 90, end_year: Date.today.year, order: [:month, :day,  :year], label: "Date of Birth" %>
                </div>
                <div class="do_something">
                    <%= p.input :person_date_of_death, class: "form-control", as: :date, start_year: Date.today.year - 15, end_year: Date.today.year, order: [:month, :day,  :year], label: "Date of Death" %>
                </div>
                <h5>Firearms or Weapons</h5>
                <div class="do_something">
                    <div class="field" id="person_weapon">
                        <%= p.input :person_weapon, class: "form-control", label: "General Weapon Carried/Used (handgun)" %>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="person_weapon_specific">
                        <%= p.input :person_weapon_specific, class: "form-control", label: "Specific Weapon Carried/Used (.357 magnum revolver)" %>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_unarmed, class: "form-control", label: "Person Unarmed?" %>
                            </label>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_armed, class: "form-control", label: "Person Armed?" %>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :armed_with_firearm, class: "form-control", label: "With Firearm?" %>
                            </label>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :armed_with_weapon, class: "form-control", label: "With Weapon?" %>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_weapon_recovered, class: "form-control", label: "Weapon Was Recovered" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_pointed_gun_at_officer, class: "form-control", label: "Person Pointed Firearm" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_threatened_officer_with_weapon, class: "form-control", label: "Person Initiated Physical Threat" %>
                            </label>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :used_vehicle_as_weapon, class: "form-control", label: "Officer Feared Vehicle Was Weapon" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_fired_gun_at_officer, class: "form-control", label: "Person Fired Firemarm" %>
                            </label>
                        </div>
                    </div>
                </div>
                <hr></hr>
                <h5>Was An Arrest Made?</h5>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= p.input :person_arrested, class: "form-control", label: "Person Arrested" %>
                    </label>
                </div>
                <div class="do_something">
                    <div class="field" id="notes">
                        <%= p.input :person_criminal_case_file_number, class: "form-control", label: "Case Number" %>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="notes">
                        <%= p.input :person_charges_filed, class: "form-control", label: "Charges" %>
                    </div>
                </div>
                <h5>Drugs or Alcohol</h5>
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_signs_of_impairment, class: "form-control", label: "Signs of Drugs or Alcohol?" %>
                            </label>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :marijuana_alone, class: "form-control", label: "Marijuana Was The Only Drug?" %>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="drugs">
                    <%= p.input :drugs, class: "form-control", label: "Drugs Present Based On DA/Coroner (Separate With Commas)" %>
                    </div>
                </div>
                <h5>Factors Present (Check box if true)</h5>
                <div class="do_something">
                    <div class="field" id="reason_for_shooting">
                    <%= p.input :reason_for_shooting, collection: ["attempted to disarm deputy", "bystander in shooting", "led to believe was armed", "object shooting", "other person was target", "perception shooting", "vehicle as weapon"], label: false, :default => nil, :prompt => " --Select One-- ", class: "form-control", label: "Reason For Shooting" %>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_reached_for_waistband, class: "form-control", label: "Reached For Waistband Or Pants" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_ignored_officer_commands, class: "form-control", label: "Ignored Officer Commands" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_grabbed_for_officers_weapon_holster, class: "form-control", label: "Grabbed For Officers Weapon/Holster" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_shot_in_back, class: "form-control", label: "Was Shot In The Back?" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_shot_in_head, class: "form-control", label: "Was Shot In The Head?" %>
                            </label>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_signs_of_mental_illness, class: "form-control", label: "Signs Of Mental Illness" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_signs_of_gang_affiliation, class: "form-control", label: "Suspected To Be Gang Member" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_fled_by_foot_or_vehicle, class: "form-control", label: "Foot Chase Or Vehicle Pursuit Occurred" %>
                            </label>
                        </div>
                        <div class="do_something">
                            <label class="checkbox-inline">
                            <%= p.input :person_hid_hands_from_officer, class: "form-control", label: "Hands Went Missing/Couldn't See Hands" %>
                            </label>
                        </div>
                    </div>
                </div>
                <hr></hr>
                <h5>Misc</h5>
                <div class="do_something">
                    <div class="field" id="person_media_reports_link">
                    <%= p.input :person_media_reports_link, class: "form-control", label: "Link To Media Reports" %>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="notes">
                        <%= p.input :notes, class: "form-control", label: "Notes" %>
                    </div>
                </div>
            <% end %>
        <% else %>
            <div class="do_something">
                <label class="string optional control-label" style="color: #468849;">Will open a new tab to record information about the person shot</label>
                <% @people.each do |person| %>
                    <% if person.person_name == "" %>
                        <br /><label class="string optional control-label"><%= link_to "You Forgot to Save Details for This Person", edit_person_path(person.id), :target => "_blank" %></label>
                    <% else %>
                        <br /><label class="string optional control-label"><%= link_to person.person_name, edit_person_path(person.id), :target => "_blank" %></label>
                    <% end %>
                <% end %>
                <!--
                <br /><label class="string optional control-label"><%#= link_to 'Add a person?', new_person_path(@incident.id), :target => "_blank" %></label>
                -->
            </div>
        <% end %>
        <hr></hr>
        <!-- NEED TO FIGURE OUT THE PEOPLE -->

        <!-- begin narrative data -->
        <h5>Factual Information</h5>

        <div class="do_something">
            <%= f.input :general_location_of_incident, class: "form-control", label: "Location Of Incident (Be As Specific As Possible)" %>
        </div>

        <div class="do_something">
            <%= f.input :type_of_incident, class: "form-control", label: "Force Used By Officer (In Order Of Use, Separated By Commas)" %>
        </div>

        <div class="do_something">
            <%= f.input :type_of_incident_number, class: "form-control", label: "How Many Uses Of Force (1, 2, 3)" %>
        </div>

        <div class="do_something">
            <%= f.input :officer_shots_fired_specific, class: "form-control", label: "Shots Fired In Incident (10, more than 50)" %>
        </div>

        <div class="do_something">
            <%= f.input :led_to_response_category, collection: ["domestic violence", "general disturbance", "implied weapon is present", "lower-level crime", "suicidal/wants to die", "suspicious or inquisitive cop", "traffic violation", "violent/serious crime", "other"], label: false, :default => nil, :prompt => " --Select One-- ", class: "form-control", label: "Categorize What Led To An Officer Response/Shooting" %>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :underlying_crime_leading_to_shooting, class: "form-control", label: "Describe What Led To An Officer Response/Shooting" %>
            </div>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :how_situation_escalated, class: "form-control", label: "What Caused Situation to Escalate" %>
            </div>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :what_happened, class: "form-control", label: "What Happened Then" %>
            </div>
        </div>
        <!-- end narrative data -->

        <hr></hr>

        <!-- begin various factors present -->
        <h5>Factors Present (Check box if true)</h5>
        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :officer_special_unit, class: "form-control", label: "Officer Special Unit" %>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_serving_warrant, class: "form-control", label: "Officer Serving Warrant" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_on_surveillance, class: "form-control", label: "Officer On Surveillance" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_routine_patrol, class: "form-control", label: "Officer On Routine Patrol" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_responding_to_call, class: "form-control", label: "Officer Responding to Call" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_on_undercover, class: "form-control", label: "Officer Undercover" %>
                    </label>
                </div>
            </div>
            <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :officer_injured, class: "form-control", label: "Officer Injured" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :car_stop, class: "form-control", label: "Car Stop" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :civilian_witnesses, class: "form-control", label: "Civilian Witnesses" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :potential_civillian_video, class: "form-control", label: "Potential Civillian Video" %>
                    </label>
                </div>
                <div class="do_something">
                    <label class="checkbox-inline">
                        <%= f.input :potential_police_video, class: "form-control", label: "Potential Police Video" %>
                    </label>
                </div>
            </div>
        </div>
        <!-- end various factors present -->

        <hr></hr>

        <!-- begin additional data -->
        <h5>Narrative Information &amp; Notes</h5>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :narrative_notes, class: "form-control", label: "Narrative Notes" %>
            </div>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :conclusion_notes, class: "form-control", label: "Conclusion Notes" %>
            </div>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :autopsy_notes, class: "form-control", label: "Autopsy Notes" %>
            </div>
        </div>

        <div class="do_something">
            <label class="checkbox-inline">
            <%= f.input :flag_for_followup, class: "form-control", label: "Is This Incident Notable?" %>
            </label>
        </div>

        <div class="do_something">
            <div class="field" id="notes">
                <%= f.input :district_attorney_prepared_report, class: "form-control", label: "District Attorney Report Prepared By" %>
            </div>
        </div>
        <!-- end additional data -->

        <% if @incident.transcribed == false %>
            <%= f.input :user_email, :as => :hidden, input_html: {value: @user.email} %>
            <%= f.input :user_id, :as => :hidden, :input_html => { :value => @user_id } %>
        <% else %>
            <% if @incident.verified == false %>
                <%= f.input :verified_by_email, :as => :hidden, input_html: {value: @user.email} %>
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <div class="field" id="notes">
                                <%= f.input :transcribed, class: "form-control", label: "Transcribed" %>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="do_something">
                            <div class="field" id="notes">
                                <%= f.input :user_email, class: "form-control", label: "Transcribed By" %>
                            </div>
                        </div>
                    </div>
                </div>
            <% else %>
                <div class="do_something">
                    <div class="field" id="notes">
                        <%= f.input :user_email, class: "form-control", label: "Transcribed By", input_html: {value: @user.email} %>
                    </div>
                </div>
                <div class="do_something">
                    <div class="field" id="notes">
                        <%= f.input :verified_by_email, class: "form-control", label: "Verified By", input_html: {value: @user.email} %>
                    </div>
                </div>
            <% end %>
        <% end %>

        <%= hidden_field_tag "incident_id", @incident.id %>
        <%= hidden_field_tag :redirect_location, "/incidents/#{@incident.id}" %>

    </div>
<% end %>
